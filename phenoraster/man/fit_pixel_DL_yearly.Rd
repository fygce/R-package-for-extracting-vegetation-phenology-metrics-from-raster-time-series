% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_pixel_DL_yearly.R
\name{fit_pixel_DL_yearly}
\alias{fit_pixel_DL_yearly}
\title{Fit double-logistic (DL) curve for a single pixel across years}
\usage{
fit_pixel_DL_yearly(
  y_all,
  doy_all,
  year_vec,
  pixel_index = NULL,
  years_sel = NULL,
  min_n = 6
)
}
\arguments{
\item{y_all}{Numeric vector. Time series of the pixel (e.g., GPP).}

\item{doy_all}{Numeric vector. Day-of-year corresponding to each observation in y_all.}

\item{year_vec}{Integer vector. Year corresponding to each observation in y_all.}

\item{pixel_index}{Optional integer. If provided, enables plotting of per-year fits for debugging.}

\item{years_sel}{Optional integer vector. Subset of years to fit. Defaults to all years in year_vec.}

\item{min_n}{Integer. Minimum number of valid points required to fit a year. Default is 6.}
}
\value{
A named list of fitted results for each year. Each element contains:
\itemize{
  \item \code{par} - fitted DL parameters,
  \item \code{t_obs} - original DOY values,
  \item \code{y_obs} - original values,
  \item \code{t_dense} - daily interpolated DOY for fitted curve,
  \item \code{fhat} - fitted values corresponding to \code{t_dense}.
}
}
\description{
This function fits the Zhang double-logistic curve to a pixel time series
on a per-year basis. It can be used for both single-pixel debugging (with plotting)
and for global raster processing (without plotting).
}
\examples{
\dontrun{
library(terra)
library(phenofit)
r <- rast("H:/cmip6_gpp/historical/ACCESS-ESM1-5/tif_lon180/gpp_195001.tif")
vals <- values(r)
pixel_index <- 1222
v_all <- vals[pixel_index, ]
doy <- as.numeric(format(dates, "\%j"))
years <- as.integer(format(dates, "\%Y"))
fits <- fit_pixel_DL_yearly(v_all, doy, years, pixel_index = pixel_index)
}

}
